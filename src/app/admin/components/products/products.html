<div class="w-full min-h-[80vh] justify-center flex mt-20 ">
    <div class="w-full md:w-4/5">
        <div class="w-full max-w-[95vw]">

            <!-- Header Section -->
            <div class="bg-slate-50/50  rounded-xl shadow-lg p-6 mb-4 border border-slate-200">

                <!-- Action Buttons Row -->
                <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">

                    <div>
                        <h2 class="text-2xl font-bold  text-gray-800  bg-clip-text ">
                            Manage Products
                        </h2>
                        <p class="text-sm text-gray-500 mt-1 capitalize">Organize and track your inventory</p>
                    </div>

                    <!-- // search -->
                    <div class="relative  w-full lg:w-2/5">
                        <i class="pi pi-search absolute right-4 top-1/2 -translate-y-1/2 text-gray"></i>

                        <input type="text" [(ngModel)]="globalFilterValue" (input)="onGlobalFilter($event)"
                            placeholder="Search products, categories, status..." class="w-full h-11  bg-[#14B8A6]  rounded-sm pl-4 pr-12 
                              transition-all" />
                    </div>

                    <!-- // btn -->
                    <div class="flex gap-3 w-full lg:w-auto">
                        <button pButton type="button" label="New Product" icon="pi pi-plus"
                            class="p-button-sm flex-1 lg:flex-none 
                            bg-[#14B8A6]! text-white! 
                             border-0! rounded-lg! px-6! py-2.5! font-medium! shadow-lg! hover:shadow-xl! transition-all!" (click)="openNew()">
                        </button>
                        <button pButton type="button" label="Delete" icon="pi pi-trash"
                            class="p-button-sm flex-1 lg:flex-none bg-white! text-red-600! border-2! border-red-200! hover:bg-red-50! hover:border-red-300! rounded-lg! px-6! py-2.5! font-medium! transition-all!"
                            [disabled]="!selectedProducts || selectedProducts.length === 0"
                            (click)="deleteSelectedProducts()">
                        </button>
                    </div>


                </div>

            </div>

            <!-- Table Section -->
            <div class=" rounded-xl shadow-xl border border-slate-200 overflow-hidden">

                <p-table class="modern-table" #dt [value]="mutableProducts" [rows]="10" [paginator]="true"
                    [rowsPerPageOptions]="[5, 10, 20, 30]" [showCurrentPageReport]="true"
                    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                    [(selection)]="selectedProducts" [rowHover]="true" dataKey="id"
                    [globalFilterFields]="['id', 'name', 'price', 'category', 'brand', 'ratings', 'stock' ]"
                    styleClass="p-datatable-sm " [tableStyle]="{'min-width': '72rem'}" [scrollable]="true">


                    <!-- Header -->
                    <ng-template pTemplate="header">
                        <tr class="bg-slate-50/50 ">
                            <th class="py-4! px-4! text-base" style="width: 3rem">
                                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                            </th>

                            @for (item of tableHeaders; track $index) {
                            @if (item.icon == null) {
                            <th [style]="item.width"
                                class="py-4! px-4! font-semibold! text-xs! text-gray-700! tracking-wide!">
                                {{item.title | uppercase}}
                            </th>
                            }
                            @else {
                            <th [pSortableColumn]="item.title" [style]="item.width"
                                class="py-4!  px-4! font-semibold! text-xs! text-gray-700! tracking-wide!">
                                {{item.title | uppercase}}
                                <p-sortIcon field="item.title"></p-sortIcon>
                            </th>
                            }
                            }
                        </tr>
                    </ng-template>

                    <!-- Body -->
                    <ng-template pTemplate="body" let-product let-rowIndex="rowIndex">
                        <tr
                            class="border-b border-slate-100 hover:cursor-pointer   transition-all duration-200 hover:shadow-sm">


                            @for (col of tableSchema; track $index) {
                            <td class=" hover:cursor-pointer">

                                @switch (col.element) {

                                @case('p-tableCheckbox') {
                                <p-tableCheckbox [value]="product"></p-tableCheckbox>
                                }

                                @case('span') {
                                <span [class]="col.class + ' text-sm md:text-base text-gray-700'">
                                    @if (col.pipe) {
                                    {{ product[col.field] | number:'1.2-2' }}
                                    } @else if (col.field) {
                                    {{ product[col.field] }}
                                    }
                                </span>
                                }

                                @case('img') {
                                <img [src]="col.field ? product[col.field] : ''"
                                    [alt]="col.altField ? product[col.altField] : ''"
                                    [class]="col.class + ' rounded-lg shadow-sm hover:shadow-md  transition-shadow'" />
                                }

                                @case('p-rating') {
                                <p-rating [ngModel]="col.field ? product[col.field] : null" [readonly]="col.readonly"
                                    [ngClass]="col.class">
                                </p-rating>
                                }



                                }
                            </td>
                            }

                            <td class="!py-1">
                                <div class="flex gap-2 justify-end">
                                    <button pButton pRipple type="button" icon="pi pi-pencil" class="w-9! h-9! rounded-lg! bg-slate-100! hover:bg-slate-200! 
                                        text-slate-700! border-0! shadow-sm! hover:shadow-md! transition-all"
                                        (click)="editProduct(product)" pTooltip="Edit" tooltipPosition="top">
                                    </button>

                                    <button pButton pRipple type="button" icon="pi pi-trash"
                                        class="w-9! h-9! rounded-lg! bg-red-50! hover:bg-red-100! text-red-600! border-0! shadow-sm! hover:shadow-md! transition-all"
                                        (click)="deleteProduct(product)" pTooltip="Delete" tooltipPosition="top">
                                    </button>
                                </div>
                            </td>

                        </tr>
                    </ng-template>

                    <!-- Empty Message -->
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="9" class="text-center! py-16! text-gray-400!">
                                <div class="flex flex-col items-center justify-center">
                                    <i class="pi pi-inbox text-6xl mb-4 text-gray-300"></i>
                                    <p class="text-xl font-medium text-gray-500">No products found</p>
                                    <p class="text-sm text-gray-400 mt-2">Try adjusting your search or add a new product
                                    </p>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>

            </div>
        </div>

        <!-- Create/Edit Product Dialog -->

        <!-- Confirmation Dialog -->
        <p-confirmDialog></p-confirmDialog>
    </div>
</div>